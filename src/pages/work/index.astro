---
import BaseLayout from '../../layouts/BaseLayout.astro';
import ImageCard from '../../components/ImageCard.astro';
import { getCollection } from 'astro:content';

// Get all work series and sort by order
const allWorks = await getCollection('works');
const works = allWorks.sort((a, b) => (a.data.order ?? 999) - (b.data.order ?? 999));
---

<BaseLayout title="Work - Mika Revell">
  <h1 class="text-2xl lg:text-3xl font-semibold mb-8">Work</h1>

  <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 lg:gap-8">
    {works.map((work) => (
      <article class="group">
        <a href={`/work/${work.data.slug}`} class="block">
          <div class="overflow-hidden bg-surface mb-4">
            <img
              src={work.data.coverImage}
              alt={work.data.title}
              class="w-full aspect-[4/3] object-cover transition-transform duration-300 ease-out group-hover:scale-[1.02]"
              loading="lazy"
            />
          </div>
          <h2 class="text-lg font-normal group-hover:text-accent transition-colors">
            {work.data.title}
          </h2>
          {work.data.year && (
            <p class="text-sm text-text-muted mt-1">{work.data.year}</p>
          )}
        </a>
      </article>
    ))}
  </div>

  {works.length === 0 && (
    <div class="text-center py-20 text-text-muted">
      <p>No work series yet.</p>
    </div>
  )}
</BaseLayout>
